#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#  Configuration file 
#  author: guillaume.aubert@ctbto.org
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#  Name : DatabaseAccess
#  Info : Connection Configuration Database
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[DatabaseAccess]
# jdbc driver 
driverClassName=oracle.jdbc.driver.OracleDriver
# jdbc url (should be something like jdbc:mysql://localhost:3306/vmc)
# devlan Url
# working one on devlan
#url=oracle://aubert:ernest25@idcdev
#url=oracle://rmsuser:rmsuser@maui
url=oracle://rmsman:rmsman@172.27.72.5
#url=oracle://rmsman:rmsman@localhost
# uid
# devlan user
#uid=centre
uid=rmsuser
# password
# devlan
#password=data
password=rmsuser

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#  Name : TemplatingSystem
#  Info : Information for the XML templating engine
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[TemplatingSystem]
# Base Template to load
baseTemplate=../etc/ext/SAMPMLTemplate.xml

particulateSpectrumTemplate=
    <Spectrum id="${SPECTRUM_ID}" calibrationIDs="en2ch re2en ef2en">
	   <CollectionStart>${COL_START}</CollectionStart>
	   <CollectionStop>${COL_STOP}</CollectionStop>
	   <AcquisitionStart>${ACQ_START}</AcquisitionStart>
	   <AcquisitionStop>${ACQ_STOP}</AcquisitionStop>
	   <RealAcquisitionTime>${REAL_ACQ_TIME}</RealAcquisitionTime>
	   <LiveAcquisitionTime>${LIVE_ACQ_TIME}</LiveAcquisitionTime>
       <SamplingTime>${SAMPLING_TIME}</SamplingTime>
	   <DecayTime>${DECAY_TIME}</DecayTime>
	   <MeasurementType>${MEASUREMENT_TYPE}</MeasurementType> 
	   <SampleType>${SAMPLE_TYPE}</SampleType>      
	   <Data gammaChannelSpan="${SPECTRUM_DATA_CHANNEL_SPAN}" gammaEnergySpan="${SPECTRUM_DATA_ENERGY_SPAN}" format="IMS2.0">
         ${SPECTRUM_DATA}
       </Data>
    </Spectrum>

particulateNuclideTemplate=
    <Nuclide quantifiable="${QUANTIFIABLE}" reportMDA="${REPORTMDA}">
		<Name>${NAME}</Name>
        <Type>${TYPE}</Type>
        <HalfLife>${HALFLIFE}</HalfLife>
		<Concentration unit="uBq/m3">${CONCENTRATION}</Concentration>  <!-- check but it might need to be optional -->
	    <ConcentrationError unit="percentage">${CONCENTRATION_ERROR}</ConcentrationError>
		<MDA unit="uBq/m3">${MDA}</MDA>
	    <NuclideIdentificationIndicator>${IDENTIFICATION_INDICATOR}</NuclideIdentificationIndicator> 
    </Nuclide> 

particulateNuclideLinesTemplate=
    <IdedNuclideLine peakID="{PEAKID}">                                      <!--  peakID is optional because all lines are attached to a peak --> 
		<Name>${NAME}</Name>                                                 <!-- Name of the Nuclide associated with the Line -->
	    <Activity unit="mBq">${ACTVITY}</Activity>                           <!-- Activity and Error        -->
		<Energy unit="keV">${ENERGY}</Energy>                                
		<Abundance unit="percent">${ABUNDANCE}</Abundance>                   
		<Efficiency unit="percent">${EFFICIENCY}</Efficiency>                
		<MDA unit="uBq/m3">${MDA}</MDA>                                      
	</IdedNuclideLine>         

particulateCategoryTemplate=
     <Category>${CATEGORY}</Category>
	 <CategoryComment>${CATEGORY_COMMENT}</CategoryComment>

particulateAnalysisTemplate=
   <Analysis id="${ANALYSISID}" spectrumIDs="${SPECTRUM_ID}"> 
	  <SampleCategorization> 
		  ${CATEGORY}
	  </SampleCategorization>
	  <IdedNuclides>
		  ${NUCLIDES}
	  </IdedNuclides>
		     <IdedNuclideLines>
		      ${NUCLIDELINES}                                    
		     </IdedNuclideLines>
			 <PeakResults>
		      ${PEAKS}
			 </PeakResults>
			 <Parameters>
			  ${PARAMETERS}
		    </Parameters>
		    <Flags>
			  ${FLAGS}
		</Flags>
   </Analysis>
	
particulateQuantifiedTemplate=
   <Nuclide>
		<Name>${NAME}</Name>
		<Type>${TYPE}</Type>
		<HalfLife>${HALFLIFE}</HalfLife>
		<Concentration unit="uBq/m3">${CONCENTRATION}</Concentration>
		<ConcentrationError unit="percentage">${CONCENTRATION_ERROR}</ConcentrationError>
	</Nuclide>
	
particulateMDATemplate=
	<Nuclide>
		<Name>${NAME}</Name>
		<HalfLife>${HALFLIFE}</HalfLife>
	    <MDA unit="mBq">${MDA}</MDA>
	</Nuclide>
	
peaksTemplate=
    <PeakResult>
		<Energy>${ENERGY}</Energy>
		<Centroid>${CENTROID}</Centroid>
		<Area>${AREA}</Area>
		<Width>${WIDTH}</Width>
		<FWHM>${FWHM}</FWHM>
		<BackgroundCounts>${BACKGROUNDCOUNTS}</BackgroundCounts>
		<Efficiency>${EFFICIENCY}</Efficiency>
		<LC>${LC}</LC>
		<LD>${LD}</LD>
		<Detectibility>${DETECTIBILITY}</Detectibility>
		<IdentifiedNuclide percentage="${NUCLIDE_PERCENTAGE}">${NUCLIDE}</IdentifiedNuclide>
	</PeakResult>
	
processingParametersTemplate=
           <ProcessingParameters software="${SOFTWARE}" method="${METHOD}" version="${VERSION}">
				<Threshold>${THRESHOLD}</Threshold>
				<PeakStart unit="keV">${PEAK_START}</PeakStart>
				<PeakEnd unit="keV">${PEAK_END}</PeakEnd>
				<LeftFWHMLimit>${LEFT_FWHM}</LeftFWHMLimit>
				<RightFWHMLimit>${RIGHT_FWHM}</RightFWHMLimit>
				<MutlipletFWHMLimit>${MULTI_FWHM}</MutlipletFWHMLimit>
				<FitSinglets>${FIT_SINGLETS}</FitSinglets>
				<CriticalLevelTest>${CRITICAL_LEV_TEST}</CriticalLevelTest>
				<EstimatePeakWidths>${ESTIMATED_PEAK_WIDTHS}</EstimatePeakWidths>
				<BaselineType>${BASELINE_TYPE}</BaselineType>
				<BaselineChannels>${BASELINE_CHANNELS}</BaselineChannels>
				<PerformSubstraction>${SUBSTRACTION}</PerformSubstraction>
				<EnergyTolerance>${ENERGY_TOLERANCE}</EnergyTolerance>
				<ConfidenceThreshold>${CONFIDENCE_THRESHOLD}</ConfidenceThreshold>
				<RiskLevel unit="percentage">${RISK_LEVEL}</RiskLevel>
			</ProcessingParameters>

updateParametersTemplate=
            <UpdateParameters software="${SOFTWARE}" method="${METHOD}" version="${VERSION}">
				<UseMRP>${USE_MRP}</UseMRP>
				<MRPSampleID>${MRP_SAMPLEID}</MRPSampleID>
				<GainShift unit="percentage">${GAIN_SHIFT}</GainShift>
				<ZeroShift>${ZERO_SHIFT}</ZeroShift>
				<AreaLimit>${AREA_LIMIT}</AreaLimit>
				<UseWeight>${USE_WEIGHT}</UseWeight>
				<UseMultiplet>${USE_MULTIPLET}</UseMultiplet>
				<ForceLinear>${FORCE_LINEAR}</ForceLinear>
				<IgnorePreviousECR>${IGNORE_PREVIOUS_ECR}</IgnorePreviousECR>
				<MinimumLibLookupTolerance>${MINIMUM_LIB_LOOKUP_TOLERANCE}</MinimumLibLookupTolerance>
				<RERIntercept>${RER_INTERCEPT}</RERIntercept>
				<RERSlope>${RER_SLOPE}</RERSlope>
				<ECRSlope>${ECR_SLOPE}</ECRSlope>
				<DoResolutionUpdate>${DO_RESOLUTION_UPDATE}</DoResolutionUpdate>
			</UpdateParameters>

timelinessFlagsTemplate =
           <TimelinessAndAvailabilityFlags>
				<PreviousSamplePresent>${PreviousSamplePresent}</PreviousSamplePresent>
				<CollectionTimeWithin24Hrs>${CollectionTime}</CollectionTimeWithin24Hrs>
				<AcquisitionTimeGTE20Hrs>${AcquisitionTime}</AcquisitionTimeGTE20Hrs>
				<DecayTimeLTE24Hrs>${DecayTime}</DecayTimeLTE24Hrs>
				<SampleReceived72HrsFromCollectStart>${SampleReceived}</SampleReceived72HrsFromCollectStart>
			</TimelinessAndAvailabilityFlags>
			
dataQualityFlagsTemplate =
             <DataQualityFlags>
				<Ba140MDC>
					<Value>${Ba140_MDC_VAL}</Value>
					<Pass>${Ba140_MDC_PASS}</Pass>
					<Test>lower than ${Ba140_MDC_THRESOLD}</Test>
				</Ba140MDC>
				<K40LocationDifference>
					<Value>${K40_LocationDifference_VAL}</Value>
					<Pass>${K40_LocationDifference_PASS}</Pass>
					<Test>lower than 3 * std deviation</Test>
				</K40LocationDifference>
				<NormalizedGainDifference>
					<Value>${NormalizedGainDifference_VAL}</Value>
					<Pass>${NormalizedGainDifference_PASS}</Pass>
					<Test>lower than ${NormalizedGainDifference_THRESOLD}</Test>
				</NormalizedGainDifference>
				<Be7FWHM>
					<Value>${Be7_FWHM_VAL}</Value>
					<Pass>${Be7_FWHM_PASS}</Pass>
					<Test>lower than ${Be7_FWHM_THRESOLD}</Test>
				</Be7FWHM>
				<FlowRate>
					<Value>${FlowRate_VAL}</Value>
					<Pass>${FlowRate_PASS}</Pass>
					<Test>greater than ${FlowRate_THRESOLD}</Test>
				</FlowRate>
			</DataQualityFlags>
			
eventScreeningFlagsTemplate =
			<EventScreeningFlags>
				<ActivationProductsPresent>true</ActivationProductsPresent>
				<NbOfDaysSinceLastActivationProduct>48.9999</NbOfDaysSinceLastActivationProduct>
				<OnlyOneFissionProductPresent>false</OnlyOneFissionProductPresent>
				<TwoOrMoreFissionProductsPresent>false</TwoOrMoreFissionProductsPresent>
				<CS-137Present>false</CS-137Present>
			</EventScreeningFlags>
			
particulateEnergyCalTemplate=
          <Calibration Type="EnergyToChannels" EnergyUnits="keV" ID="en2ch">
				<Remark>Energy to Channel Calibration equation</Remark>
				<CalibrationCreationDate>2007-11-24T12:09:53.89</CalibrationCreationDate>
				<Equation Model="Polynomial" Form="E(c)= Term0 + Term1 * c + Term2 * C^2 + Term3 * C^3" >
					<Remark>The coefficients taken from the database will have more decimals (higher precision) </Remark>
					<Coefficients>${TERM0} ${TERM1} ${TERM2} ${TERM3}</Coefficients>
				</Equation>
		  </Calibration>
		  
particulateResolutionCalTemplate=
          <Calibration Type="ResolutionToEnergy" EnergyUnits="keV" FWHMUnits="Energy" ID="re2en">
				<Remark>Resolution to Energy Calibration equation</Remark>
				<CalibrationCreationDate>2007-11-24T12:09:53.89</CalibrationCreationDate>
				<Equation Model="Polynomial" Form="FWHM(E)= Term0 + Term1 * SQRT(E)">
					<Remark>The coefficients taken from the database will have more decimals (higher precision) </Remark>
					<Coefficients>${TERM0} ${TERM1}</Coefficients>
				</Equation>
		  </Calibration>
		  
particulateEfficencyCalTemplate=
          <Calibration Type="EfficiencyToEnergy" EnergyUnits="keV" FWHMUnits="Energy" ID="ef2en">
				<Remark>Resolution to Energy Calibration equation</Remark>
				<CalibrationCreationDate>2007-11-24T12:09:53.89</CalibrationCreationDate>
				<Equation Model="PolyLogarithmic" Form="L(E)=ln(${LN_TERM0}/E)">
					<Remark>None</Remark>
					<Coefficients>${LN_TERM0}</Coefficients>
				</Equation>
				<Equation Model="Exponential" Form="e(E)= exp( Term0 + Term1*L + Term2 * L^2 + Term3* L^3 + Term4 * L^4 + Term5 * L^5)">
					<Remark>None</Remark>
					<Coefficients>${TERM0} ${TERM1} ${TERM2} ${TERM3} ${TERM4} ${TERM5}</Coefficients>
				</Equation>
			</Calibration>


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#  Name : FileSystem
#  Info : IDC FileSystem info
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
dataRootDir=/home/misc/rmsops/data

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#  Name : RawDBRenderer
#  Info : Connection Configuration Database
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[RawDBRenderer]
static_tables=RMSAUTO.GARDS_STATIONS, RMSAUTO.FPDESCRIPTION
#dynamic_tables=RMSAUTO.GARDS_SAMPLE_DATA, RMSAUTO.GARDS_SPECTRUM, RMSAUTO.GARDS_SAMPLE_AUX
dynamic_tables=RMSAUTO.GARDS_SAMPLE_DATA, RMSAUTO.GARDS_USER_COMMENTS, RMSAUTO.GARDS_SPECTRUM, RMSAUTO.GARDS_SAMPLE_AUX, RMSAUTO.GARDS_SAMPLE_DESCRIPTION, RMSAUTO.GARDS_SAMPLE_FLAGS, RMSAUTO.GARDS_SAMPLE_CERT, RMSAUTO.GARDS_SAMPLE_CERT_LINES, RMSAUTO.GARDS_SAMPLE_PROC_PARAMS, RMSAUTO.GARDS_SAMPLE_RATIOS, RMSAUTO.GARDS_SAMPLE_STATUS, RMSAUTO.GARDS_SAMPLE_UPDATE_PARAMS, RMSAUTO.GARDS_COMMENTS, RMSAUTO.GARDS_EFFICIENCY_CAL, RMSAUTO.GARDS_EFFICIENCY_PAIRS , RMSAUTO.GARDS_ENERGY_CAL, RMSAUTO.GARDS_ENERGY_CAL_COV, RMSAUTO.GARDS_ENERGY_CAL_ORIG, RMSAUTO.GARDS_ENERGY_PAIRS, RMSAUTO.GARDS_ENERGY_PAIRS_ORIG, RMSAUTO.GARDS_HISTOGRAM, RMSAUTO.GARDS_NUCL_IDED,RMSAUTO.GARDS_NUCL_IDED_ORIG,RMSAUTO.GARDS_NUCL_LINES_IDED,RMSAUTO.GARDS_PEAKS,RMSAUTO.GARDS_PEAKS_ORIG,RMSAUTO.GARDS_QC_RESULTS,RMSAUTO.GARDS_RESOLUTION_CAL,RMSAUTO.GARDS_RESOLUTION_CAL_COV,RMSAUTO.GARDS_RESOLUTION_PAIRS, RMSAUTO.GARDS_ROI_CHANNELS
# remove RMSAUTO.GARDS_ROI_LIMITS which hasn't got any indexes , GARDS_SAMPLE_RATIOS hasn't got any as well
#limits=RMSAUTO.GARDS_STATIONS:4
extractionDir=/tmp/DB-Extract

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#  Name : Transformer
#  Info : Transform XML into something else
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[Transformer]
xsltPrettyPrinter=../etc/ext/pretty-print.xslt

